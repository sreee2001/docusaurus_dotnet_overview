<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Topics/DevOps_and_CI_CD/HealthChecks" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">HealthChecks | .NET and Azure Overview</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://sreee2001.github.io/docusaurus_dotnet_overview/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://sreee2001.github.io/docusaurus_dotnet_overview/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/HealthChecks"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="HealthChecks | .NET and Azure Overview"><meta data-rh="true" name="description" content="43. Health Checks"><meta data-rh="true" property="og:description" content="43. Health Checks"><link data-rh="true" rel="icon" href="/docusaurus_dotnet_overview/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/HealthChecks"><link data-rh="true" rel="alternate" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/HealthChecks" hreflang="en"><link data-rh="true" rel="alternate" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/HealthChecks" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HealthChecks","item":"https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/HealthChecks"}]}</script><link rel="alternate" type="application/rss+xml" href="/docusaurus_dotnet_overview/blog/rss.xml" title=".NET and Azure Overview RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docusaurus_dotnet_overview/blog/atom.xml" title=".NET and Azure Overview Atom Feed"><link rel="stylesheet" href="/docusaurus_dotnet_overview/assets/css/styles.bda66df9.css">
<script src="/docusaurus_dotnet_overview/assets/js/runtime~main.fd4f44a3.js" defer="defer"></script>
<script src="/docusaurus_dotnet_overview/assets/js/main.41b91b68.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docusaurus_dotnet_overview/"><b class="navbar__title text--truncate">Quick References</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurus_dotnet_overview/docs/intro">Overviews</a><a class="navbar__item navbar__link" href="/docusaurus_dotnet_overview/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/sreee2001" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus_dotnet_overview/docs/intro"><span title="Welcome to .NET &amp; Azure Overview" class="linkLabel_WmDU">Welcome to .NET &amp; Azure Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docusaurus_dotnet_overview/docs/Topics/Fundamentals/dotnet_versions"><span title="Topics" class="categoryLinkLabel_W154">Topics</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Fundamentals/dotnet_versions"><span title="Fundamentals" class="categoryLinkLabel_W154">Fundamentals</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/CoreDevelopment/asp_dotnet_core"><span title="CoreDevelopment" class="categoryLinkLabel_W154">CoreDevelopment</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/WebTechnologies/mvc"><span title="WebTechnologies" class="categoryLinkLabel_W154">WebTechnologies</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DataAccessAndPersistence/entity_framework_core_advanced"><span title="DataAccessAndPersistence" class="categoryLinkLabel_W154">DataAccessAndPersistence</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Testing/unit_testing"><span title="Testing" class="categoryLinkLabel_W154">Testing</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/PerformanceAndScalability/caching"><span title="PerformanceAndScalability" class="categoryLinkLabel_W154">PerformanceAndScalability</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/CloudTechnologies/azure_app_service"><span title="CloudTechnologies" class="categoryLinkLabel_W154">CloudTechnologies</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/ContainerizationAndOrchestration/docker"><span title="ContainerizationAndOrchestration" class="categoryLinkLabel_W154">ContainerizationAndOrchestration</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/azure_devops"><span title="DevOps_and_CI_CD" class="categoryLinkLabel_W154">DevOps_and_CI_CD</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/azure_devops"><span title="Azure DevOps" class="linkLabel_WmDU">Azure DevOps</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/github_actions"><span title="GitHub Actions" class="linkLabel_WmDU">GitHub Actions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/application_insights"><span title="Application Insights (Observability + Instrumentation)" class="linkLabel_WmDU">Application Insights (Observability + Instrumentation)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/HealthChecks"><span title="HealthChecks" class="linkLabel_WmDU">HealthChecks</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Microservices/MicroservicesArchitecture"><span title="Microservices" class="categoryLinkLabel_W154">Microservices</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Security/IdentityServer"><span title="Security" class="categoryLinkLabel_W154">Security</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/gRPC"><span title="AdvancedTopics" class="categoryLinkLabel_W154">AdvancedTopics</span></a></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docusaurus_dotnet_overview/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Topics</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">DevOps_and_CI_CD</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">HealthChecks</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>HealthChecks</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="43-health-checks">43. Health Checks<a href="#43-health-checks" class="hash-link" aria-label="Direct link to 43. Health Checks" title="Direct link to 43. Health Checks" translate="no">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="short-introduction">Short Introduction<a href="#short-introduction" class="hash-link" aria-label="Direct link to Short Introduction" title="Direct link to Short Introduction" translate="no">​</a></h2>
<p>Health Checks in .NET provide a systematic way to monitor the health and availability of an application and its dependencies. They offer HTTP endpoints that can be called by load balancers, monitoring systems, and orchestrators to determine if an application instance should receive traffic or needs to be restarted.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="official-definition">Official Definition<a href="#official-definition" class="hash-link" aria-label="Direct link to Official Definition" title="Direct link to Official Definition" translate="no">​</a></h2>
<p>Health Checks are diagnostic checks that can be performed on an application to determine its health status. They provide a consistent way to expose health information about an application and its dependencies, enabling monitoring systems to make informed decisions about traffic routing and instance management.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setupusage-with-net-8-code">Setup/Usage with .NET 8+ Code<a href="#setupusage-with-net-8-code" class="hash-link" aria-label="Direct link to Setup/Usage with .NET 8+ Code" title="Direct link to Setup/Usage with .NET 8+ Code" translate="no">​</a></h2>
<p><strong>Basic Health Checks Setup:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Program.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Microsoft.Extensions.Diagnostics.HealthChecks;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var builder = WebApplication.CreateBuilder(args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add basic health checks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddHealthChecks()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck(&quot;self&quot;, () =&gt; HealthCheckResult.Healthy(&quot;Application is running&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck&lt;DatabaseHealthCheck&gt;(&quot;database&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck&lt;RedisHealthCheck&gt;(&quot;redis&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck&lt;ExternalApiHealthCheck&gt;(&quot;external-api&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add health checks UI (optional)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddHealthChecksUI(options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.SetEvaluationTimeInSeconds(30);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.MaximumHistoryEntriesPerEndpoint(50);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.AddHealthCheckEndpoint(&quot;Hotel Management API&quot;, &quot;/health&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}).AddInMemoryStorage();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var app = builder.Build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Configure health check endpoints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecks(&quot;/health&quot;, new HealthCheckOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResponseWriter = WriteHealthCheckResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecks(&quot;/health/ready&quot;, new HealthCheckOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Predicate = check =&gt; check.Tags.Contains(&quot;ready&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResponseWriter = WriteHealthCheckResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecks(&quot;/health/live&quot;, new HealthCheckOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Predicate = _ =&gt; false, // Only checks with no dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResponseWriter = WriteHealthCheckResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add health checks UI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecksUI(options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.UIPath = &quot;/health-ui&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ApiPath = &quot;/health-api&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.Run();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Custom response writer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static async Task WriteHealthCheckResponse(HttpContext context, HealthReport report)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context.Response.ContentType = &quot;application/json&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var result = new</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        status = report.Status.ToString(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalDuration = report.TotalDuration.TotalMilliseconds,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        checks = report.Entries.Select(entry =&gt; new</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            name = entry.Key,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = entry.Value.Status.ToString(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            duration = entry.Value.Duration.TotalMilliseconds,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            description = entry.Value.Description,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            data = entry.Value.Data,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            exception = entry.Value.Exception?.Message,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tags = entry.Value.Tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await context.Response.WriteAsync(JsonSerializer.Serialize(result, new JsonSerializerOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PropertyNamingPolicy = JsonNamingPolicy.CamelCase,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        WriteIndented = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Custom Health Checks Implementation:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// HealthChecks/DatabaseHealthCheck.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DatabaseHealthCheck : IHealthCheck</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IConfiguration _configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger&lt;DatabaseHealthCheck&gt; _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DatabaseHealthCheck(IConfiguration configuration, ILogger&lt;DatabaseHealthCheck&gt; logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _configuration = configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;HealthCheckResult&gt; CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken = default)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var connectionString = _configuration.GetConnectionString(&quot;DefaultConnection&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            using var connection = new SqlConnection(connectionString);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await connection.OpenAsync(cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            using var command = connection.CreateCommand();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            command.CommandText = &quot;SELECT 1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            command.CommandTimeout = 5; // 5 second timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var result = await command.ExecuteScalarAsync(cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var data = new Dictionary&lt;string, object&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;server&quot;] = connection.DataSource,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;database&quot;] = connection.Database,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;connection_time&quot;] = DateTime.UtcNow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result?.ToString() == &quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ? HealthCheckResult.Healthy(&quot;Database connection successful&quot;, data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                : HealthCheckResult.Unhealthy(&quot;Database query failed&quot;, null, data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogError(ex, &quot;Database health check failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return HealthCheckResult.Unhealthy(&quot;Database connection failed&quot;, ex, new Dictionary&lt;string, object&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;error&quot;] = ex.Message,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;check_time&quot;] = DateTime.UtcNow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// HealthChecks/RedisHealthCheck.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class RedisHealthCheck : IHealthCheck</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IConnectionMultiplexer _connectionMultiplexer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger&lt;RedisHealthCheck&gt; _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public RedisHealthCheck(IConnectionMultiplexer connectionMultiplexer, ILogger&lt;RedisHealthCheck&gt; logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _connectionMultiplexer = connectionMultiplexer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;HealthCheckResult&gt; CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken = default)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var database = _connectionMultiplexer.GetDatabase();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var key = $&quot;health_check_{Guid.NewGuid()}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var value = &quot;ping&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Test write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await database.StringSetAsync(key, value, TimeSpan.FromSeconds(30));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Test read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var retrievedValue = await database.StringGetAsync(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Clean up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await database.KeyDeleteAsync(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var data = new Dictionary&lt;string, object&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;server&quot;] = _connectionMultiplexer.Configuration,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;is_connected&quot;] = _connectionMultiplexer.IsConnected,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;check_time&quot;] = DateTime.UtcNow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return retrievedValue == value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ? HealthCheckResult.Healthy(&quot;Redis connection successful&quot;, data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                : HealthCheckResult.Unhealthy(&quot;Redis read/write test failed&quot;, null, data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogError(ex, &quot;Redis health check failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return HealthCheckResult.Unhealthy(&quot;Redis connection failed&quot;, ex, new Dictionary&lt;string, object&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;error&quot;] = ex.Message,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;check_time&quot;] = DateTime.UtcNow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// HealthChecks/ExternalApiHealthCheck.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ExternalApiHealthCheck : IHealthCheck</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly HttpClient _httpClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IConfiguration _configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger&lt;ExternalApiHealthCheck&gt; _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ExternalApiHealthCheck(HttpClient httpClient, IConfiguration configuration, ILogger&lt;ExternalApiHealthCheck&gt; logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _httpClient = httpClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _configuration = configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;HealthCheckResult&gt; CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken = default)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var apiUrl = _configuration[&quot;ExternalApi:BaseUrl&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var healthEndpoint = $&quot;{apiUrl}/health&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            using var cts = CancellationTokenSource.CreateLinkedTokenSource(cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cts.CancelAfter(TimeSpan.FromSeconds(10)); // 10 second timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var response = await _httpClient.GetAsync(healthEndpoint, cts.Token);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var responseTime = DateTime.UtcNow;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var data = new Dictionary&lt;string, object&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;url&quot;] = healthEndpoint,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;status_code&quot;] = (int)response.StatusCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;response_time&quot;] = responseTime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;is_success&quot;] = response.IsSuccessStatusCode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (response.IsSuccessStatusCode)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                var content = await response.Content.ReadAsStringAsync(cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                data[&quot;response_content&quot;] = content.Length &gt; 200 ? content[..200] + &quot;...&quot; : content;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return HealthCheckResult.Healthy($&quot;External API is healthy (Status: {response.StatusCode})&quot;, data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return HealthCheckResult.Degraded($&quot;External API returned {response.StatusCode}&quot;, null, data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (TaskCanceledException ex) when (ex.InnerException is TimeoutException)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogWarning(&quot;External API health check timed out&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return HealthCheckResult.Unhealthy(&quot;External API health check timed out&quot;, ex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogError(ex, &quot;External API health check failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return HealthCheckResult.Unhealthy(&quot;External API health check failed&quot;, ex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// HealthChecks/MemoryHealthCheck.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MemoryHealthCheck : IHealthCheck</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger&lt;MemoryHealthCheck&gt; _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private const long ThresholdBytes = 1024 * 1024 * 1024; // 1 GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MemoryHealthCheck(ILogger&lt;MemoryHealthCheck&gt; logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Task&lt;HealthCheckResult&gt; CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken = default)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var process = Process.GetCurrentProcess();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var workingSet = process.WorkingSet64;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var gcTotalMemory = GC.GetTotalMemory(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var data = new Dictionary&lt;string, object&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;working_set_mb&quot;] = workingSet / (1024 * 1024),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;gc_total_memory_mb&quot;] = gcTotalMemory / (1024 * 1024),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;gen0_collections&quot;] = GC.CollectionCount(0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;gen1_collections&quot;] = GC.CollectionCount(1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;gen2_collections&quot;] = GC.CollectionCount(2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&quot;check_time&quot;] = DateTime.UtcNow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (workingSet &gt; ThresholdBytes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return Task.FromResult(HealthCheckResult.Degraded(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    $&quot;Memory usage is high: {workingSet / (1024 * 1024)} MB&quot;, null, data));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return Task.FromResult(HealthCheckResult.Healthy(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                $&quot;Memory usage is normal: {workingSet / (1024 * 1024)} MB&quot;, data));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogError(ex, &quot;Memory health check failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return Task.FromResult(HealthCheckResult.Unhealthy(&quot;Memory health check failed&quot;, ex));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases" translate="no">​</a></h3>
<ul>
<li><strong>Load Balancer Integration</strong>: Determine which instances should receive traffic</li>
<li><strong>Container Orchestration</strong>: Kubernetes liveness and readiness probes</li>
<li><strong>Monitoring Systems</strong>: Automated health monitoring and alerting</li>
<li><strong>Deployment Strategies</strong>: Blue-green and rolling deployments</li>
<li><strong>Auto-scaling</strong>: Scale up/down based on application health</li>
<li><strong>Circuit Breaker Patterns</strong>: Fail fast when dependencies are unhealthy</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-use-vs-when-not-to-use">When to Use vs When Not to Use<a href="#when-to-use-vs-when-not-to-use" class="hash-link" aria-label="Direct link to When to Use vs When Not to Use" title="Direct link to When to Use vs When Not to Use" translate="no">​</a></h2>
<p><strong>Use Health Checks when:</strong></p>
<ul>
<li>Running in containerized or orchestrated environments</li>
<li>Using load balancers for traffic distribution</li>
<li>Need automated monitoring and alerting</li>
<li>Implementing high-availability architectures</li>
<li>Running microservices that depend on external services</li>
<li>Need visibility into application and dependency health</li>
</ul>
<p><strong>Consider alternatives when:</strong></p>
<ul>
<li>Simple applications with no external dependencies</li>
<li>Development or testing environments only</li>
<li>Applications that don&#x27;t require high availability</li>
<li>Legacy systems that can&#x27;t be easily modified</li>
<li>When basic uptime monitoring is sufficient</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="market-alternatives--proscons">Market Alternatives &amp; Pros/Cons<a href="#market-alternatives--proscons" class="hash-link" aria-label="Direct link to Market Alternatives &amp; Pros/Cons" title="Direct link to Market Alternatives &amp; Pros/Cons" translate="no">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alternatives">Alternatives:<a href="#alternatives" class="hash-link" aria-label="Direct link to Alternatives:" title="Direct link to Alternatives:" translate="no">​</a></h3>
<ul>
<li><strong>Custom HTTP endpoints</strong>: Simple health status endpoints</li>
<li><strong>Application Performance Monitoring</strong>: New Relic, Datadog health monitoring</li>
<li><strong>Infrastructure monitoring</strong>: Nagios, Zabbix, Prometheus</li>
<li><strong>Cloud provider health checks</strong>: AWS ELB, Azure Load Balancer</li>
<li><strong>Service mesh health checks</strong>: Istio, Linkerd health monitoring</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pros">Pros:<a href="#pros" class="hash-link" aria-label="Direct link to Pros:" title="Direct link to Pros:" translate="no">​</a></h3>
<ul>
<li>Built into .NET ecosystem</li>
<li>Standardized approach across applications</li>
<li>Integration with monitoring and orchestration systems</li>
<li>Customizable and extensible</li>
<li>Minimal performance overhead</li>
<li>Rich reporting capabilities</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cons">Cons:<a href="#cons" class="hash-link" aria-label="Direct link to Cons:" title="Direct link to Cons:" translate="no">​</a></h3>
<ul>
<li>Requires proper implementation to be effective</li>
<li>Can add complexity to simple applications</li>
<li>Health check failures might not always indicate real issues</li>
<li>Requires monitoring system integration for full value</li>
<li>Potential security considerations for exposed endpoints</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-runnable-sample">Complete Runnable Sample<a href="#complete-runnable-sample" class="hash-link" aria-label="Direct link to Complete Runnable Sample" title="Direct link to Complete Runnable Sample" translate="no">​</a></h3>
<p><strong>Production-Ready Health Checks Implementation:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Program.cs - Complete health checks setup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Microsoft.Extensions.Diagnostics.HealthChecks;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Text.Json;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var builder = WebApplication.CreateBuilder(args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddControllers();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddHttpClient&lt;ExternalApiHealthCheck&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Configure health checks with different tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddHealthChecks()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Readiness checks - required for the app to be ready to serve traffic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck&lt;DatabaseHealthCheck&gt;(&quot;database&quot;, HealthStatus.Unhealthy, new[] { &quot;ready&quot;, &quot;database&quot; })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck&lt;RedisHealthCheck&gt;(&quot;redis&quot;, HealthStatus.Unhealthy, new[] { &quot;ready&quot;, &quot;cache&quot; })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Liveness checks - required for the app to be considered alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck(&quot;self&quot;, () =&gt; HealthCheckResult.Healthy(&quot;Application is running&quot;), new[] { &quot;live&quot; })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck&lt;MemoryHealthCheck&gt;(&quot;memory&quot;, HealthStatus.Degraded, new[] { &quot;live&quot;, &quot;memory&quot; })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Optional dependency checks - can be degraded without failing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck&lt;ExternalApiHealthCheck&gt;(&quot;external-api&quot;, HealthStatus.Degraded, new[] { &quot;external&quot; })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddCheck(&quot;disk-space&quot;, () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var drives = DriveInfo.GetDrives().Where(d =&gt; d.IsReady);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var criticalDrives = drives.Where(d =&gt; d.AvailableFreeSpace &lt; d.TotalSize * 0.1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (criticalDrives.Any())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return HealthCheckResult.Degraded($&quot;Low disk space on: {string.Join(&quot;, &quot;, criticalDrives.Select(d =&gt; d.Name))}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return HealthCheckResult.Healthy(&quot;Disk space is adequate&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }, new[] { &quot;infrastructure&quot; });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add health checks UI for development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (builder.Environment.IsDevelopment())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    builder.Services.AddHealthChecksUI(options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.SetEvaluationTimeInSeconds(15);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.MaximumHistoryEntriesPerEndpoint(100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.AddHealthCheckEndpoint(&quot;API Health&quot;, &quot;/health&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.AddHealthCheckEndpoint(&quot;Ready Check&quot;, &quot;/health/ready&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.AddHealthCheckEndpoint(&quot;Live Check&quot;, &quot;/health/live&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }).AddInMemoryStorage();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var app = builder.Build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Configure health check endpoints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecks(&quot;/health&quot;, new HealthCheckOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResponseWriter = WriteDetailedHealthCheckResponse,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AllowCachingResponses = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecks(&quot;/health/ready&quot;, new HealthCheckOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Predicate = check =&gt; check.Tags.Contains(&quot;ready&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResponseWriter = WriteDetailedHealthCheckResponse,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AllowCachingResponses = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecks(&quot;/health/live&quot;, new HealthCheckOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Predicate = check =&gt; check.Tags.Contains(&quot;live&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResponseWriter = WriteSimpleHealthCheckResponse,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AllowCachingResponses = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Kubernetes-style probes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecks(&quot;/readyz&quot;, new HealthCheckOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Predicate = check =&gt; check.Tags.Contains(&quot;ready&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResponseWriter = WriteSimpleHealthCheckResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHealthChecks(&quot;/livez&quot;, new HealthCheckOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Predicate = check =&gt; check.Tags.Contains(&quot;live&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResponseWriter = WriteSimpleHealthCheckResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Health checks UI (development only)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (app.Environment.IsDevelopment())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.MapHealthChecksUI(options =&gt; options.UIPath = &quot;/health-ui&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapControllers();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.Run();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Detailed response writer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static async Task WriteDetailedHealthCheckResponse(HttpContext context, HealthReport report)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context.Response.ContentType = &quot;application/json&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var response = new</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        status = report.Status.ToString(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalDuration = $&quot;{report.TotalDuration.TotalMilliseconds:F2}ms&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        timestamp = DateTime.UtcNow.ToString(&quot;O&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        checks = report.Entries.ToDictionary(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            kvp =&gt; kvp.Key,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            kvp =&gt; new</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                status = kvp.Value.Status.ToString(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                duration = $&quot;{kvp.Value.Duration.TotalMilliseconds:F2}ms&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                description = kvp.Value.Description,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                data = kvp.Value.Data,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exception = kvp.Value.Exception?.Message,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                tags = kvp.Value.Tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var json = JsonSerializer.Serialize(response, new JsonSerializerOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PropertyNamingPolicy = JsonNamingPolicy.CamelCase,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        WriteIndented = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await context.Response.WriteAsync(json);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Simple response writer for load balancers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static async Task WriteSimpleHealthCheckResponse(HttpContext context, HealthReport report)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context.Response.ContentType = &quot;text/plain&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var status = report.Status switch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HealthStatus.Healthy =&gt; &quot;Healthy&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HealthStatus.Degraded =&gt; &quot;Degraded&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HealthStatus.Unhealthy =&gt; &quot;Unhealthy&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _ =&gt; &quot;Unknown&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await context.Response.WriteAsync(status);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Docker health check script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// docker-healthcheck.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -f http://localhost:8080/health/live || exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Kubernetes deployment with health checks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// k8s-deployment.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: hotel-management-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  replicas: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      app: hotel-management-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        app: hotel-management-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: hotel-management-api:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - containerPort: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        livenessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            path: /livez</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            port: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          initialDelaySeconds: 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          periodSeconds: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          timeoutSeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          failureThreshold: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readinessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            path: /readyz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            port: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          initialDelaySeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          periodSeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          timeoutSeconds: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          failureThreshold: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        startupProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            path: /health</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            port: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          initialDelaySeconds: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          periodSeconds: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          timeoutSeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          failureThreshold: 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          requests:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            memory: &quot;256Mi&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cpu: &quot;250m&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          limits:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            memory: &quot;512Mi&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cpu: &quot;500m&quot;</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/application_insights"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Application Insights (Observability + Instrumentation)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docusaurus_dotnet_overview/docs/Topics/Microservices/MicroservicesArchitecture"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">MicroservicesArchitecture</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#43-health-checks" class="table-of-contents__link toc-highlight">43. Health Checks</a></li><li><a href="#short-introduction" class="table-of-contents__link toc-highlight">Short Introduction</a></li><li><a href="#official-definition" class="table-of-contents__link toc-highlight">Official Definition</a></li><li><a href="#setupusage-with-net-8-code" class="table-of-contents__link toc-highlight">Setup/Usage with .NET 8+ Code</a><ul><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a></li></ul></li><li><a href="#when-to-use-vs-when-not-to-use" class="table-of-contents__link toc-highlight">When to Use vs When Not to Use</a><ul><li><a href="#market-alternatives--proscons" class="table-of-contents__link toc-highlight">Market Alternatives &amp; Pros/Cons</a></li><li><a href="#alternatives" class="table-of-contents__link toc-highlight">Alternatives:</a></li><li><a href="#pros" class="table-of-contents__link toc-highlight">Pros:</a></li><li><a href="#cons" class="table-of-contents__link toc-highlight">Cons:</a></li><li><a href="#complete-runnable-sample" class="table-of-contents__link toc-highlight">Complete Runnable Sample</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus_dotnet_overview/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus_dotnet_overview/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/sreee2001" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Srikanth Tangella. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>