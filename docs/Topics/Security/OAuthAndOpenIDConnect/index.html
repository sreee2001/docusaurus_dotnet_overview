<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Topics/Security/OAuthAndOpenIDConnect" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">OAuthAndOpenIDConnect | .NET and Azure Overview</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://sreee2001.github.io/docusaurus_dotnet_overview/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://sreee2001.github.io/docusaurus_dotnet_overview/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/Security/OAuthAndOpenIDConnect"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="OAuthAndOpenIDConnect | .NET and Azure Overview"><meta data-rh="true" name="description" content="49. OAuth 2.0 &amp; OpenID Connect"><meta data-rh="true" property="og:description" content="49. OAuth 2.0 &amp; OpenID Connect"><link data-rh="true" rel="icon" href="/docusaurus_dotnet_overview/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/Security/OAuthAndOpenIDConnect"><link data-rh="true" rel="alternate" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/Security/OAuthAndOpenIDConnect" hreflang="en"><link data-rh="true" rel="alternate" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/Security/OAuthAndOpenIDConnect" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"OAuthAndOpenIDConnect","item":"https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/Security/OAuthAndOpenIDConnect"}]}</script><link rel="alternate" type="application/rss+xml" href="/docusaurus_dotnet_overview/blog/rss.xml" title=".NET and Azure Overview RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docusaurus_dotnet_overview/blog/atom.xml" title=".NET and Azure Overview Atom Feed"><link rel="stylesheet" href="/docusaurus_dotnet_overview/assets/css/styles.bda66df9.css">
<script src="/docusaurus_dotnet_overview/assets/js/runtime~main.fd4f44a3.js" defer="defer"></script>
<script src="/docusaurus_dotnet_overview/assets/js/main.41b91b68.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docusaurus_dotnet_overview/"><b class="navbar__title text--truncate">Quick References</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurus_dotnet_overview/docs/intro">Overviews</a><a class="navbar__item navbar__link" href="/docusaurus_dotnet_overview/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/sreee2001" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus_dotnet_overview/docs/intro"><span title="Welcome to .NET &amp; Azure Overview" class="linkLabel_WmDU">Welcome to .NET &amp; Azure Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docusaurus_dotnet_overview/docs/Topics/Fundamentals/dotnet_versions"><span title="Topics" class="categoryLinkLabel_W154">Topics</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Fundamentals/dotnet_versions"><span title="Fundamentals" class="categoryLinkLabel_W154">Fundamentals</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/CoreDevelopment/asp_dotnet_core"><span title="CoreDevelopment" class="categoryLinkLabel_W154">CoreDevelopment</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/WebTechnologies/mvc"><span title="WebTechnologies" class="categoryLinkLabel_W154">WebTechnologies</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DataAccessAndPersistence/entity_framework_core_advanced"><span title="DataAccessAndPersistence" class="categoryLinkLabel_W154">DataAccessAndPersistence</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Testing/unit_testing"><span title="Testing" class="categoryLinkLabel_W154">Testing</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/PerformanceAndScalability/caching"><span title="PerformanceAndScalability" class="categoryLinkLabel_W154">PerformanceAndScalability</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/CloudTechnologies/azure_app_service"><span title="CloudTechnologies" class="categoryLinkLabel_W154">CloudTechnologies</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/ContainerizationAndOrchestration/docker"><span title="ContainerizationAndOrchestration" class="categoryLinkLabel_W154">ContainerizationAndOrchestration</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/azure_devops"><span title="DevOps_and_CI_CD" class="categoryLinkLabel_W154">DevOps_and_CI_CD</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Microservices/MicroservicesArchitecture"><span title="Microservices" class="categoryLinkLabel_W154">Microservices</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Security/IdentityServer"><span title="Security" class="categoryLinkLabel_W154">Security</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Security/IdentityServer"><span title="IdentityServer" class="linkLabel_WmDU">IdentityServer</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Security/OAuthAndOpenIDConnect"><span title="OAuthAndOpenIDConnect" class="linkLabel_WmDU">OAuthAndOpenIDConnect</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Security/JWTTokens"><span title="JWTTokens" class="linkLabel_WmDU">JWTTokens</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Security/Https_and_TLS"><span title="Https_and_TLS" class="linkLabel_WmDU">Https_and_TLS</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/gRPC"><span title="AdvancedTopics" class="categoryLinkLabel_W154">AdvancedTopics</span></a></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docusaurus_dotnet_overview/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Topics</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Security</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">OAuthAndOpenIDConnect</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>OAuthAndOpenIDConnect</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="49-oauth-20--openid-connect">49. OAuth 2.0 &amp; OpenID Connect<a href="#49-oauth-20--openid-connect" class="hash-link" aria-label="Direct link to 49. OAuth 2.0 &amp; OpenID Connect" title="Direct link to 49. OAuth 2.0 &amp; OpenID Connect" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction" translate="no">​</a></h3>
<p>OAuth 2.0 is an authorization framework that enables applications to obtain limited access to user accounts, while OpenID Connect (OIDC) is an identity layer on top of OAuth 2.0 that provides authentication. Together, they form the foundation of modern web application security.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="official-definition">Official Definition<a href="#official-definition" class="hash-link" aria-label="Direct link to Official Definition" title="Direct link to Official Definition" translate="no">​</a></h2>
<p>OAuth 2.0 is a protocol that allows third-party services to exchange web resources on behalf of a user without exposing their password. OpenID Connect 1.0 is a simple identity layer on top of the OAuth 2.0 protocol, allowing clients to verify the identity of the end-user and obtain basic profile information.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage--setup">Usage &amp; Setup<a href="#usage--setup" class="hash-link" aria-label="Direct link to Usage &amp; Setup" title="Direct link to Usage &amp; Setup" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Install required packages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package Microsoft.AspNetCore.Authentication.OpenIdConnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package Microsoft.AspNetCore.Authentication.OAuth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package System.IdentityModel.Tokens.Jwt</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Program.cs - OAuth 2.0 &amp; OpenID Connect Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var builder = WebApplication.CreateBuilder(args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddAuthentication(options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.DefaultScheme = CookieAuthenticationDefaults.AuthenticationScheme;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.DefaultChallengeScheme = OpenIdConnectDefaults.AuthenticationScheme;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.AddCookie(CookieAuthenticationDefaults.AuthenticationScheme)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.AddOpenIdConnect(OpenIdConnectDefaults.AuthenticationScheme, options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.Authority = &quot;https://your-identity-provider.com&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ClientId = &quot;your-client-id&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ClientSecret = &quot;your-client-secret&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ResponseType = OpenIdConnectResponseType.Code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.SaveTokens = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.GetClaimsFromUserInfoEndpoint = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.Scope.Add(&quot;openid&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.Scope.Add(&quot;profile&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.Scope.Add(&quot;email&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.Scope.Add(&quot;api1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.AddOAuth(&quot;GitHub&quot;, options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ClientId = builder.Configuration[&quot;GitHub:ClientId&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ClientSecret = builder.Configuration[&quot;GitHub:ClientSecret&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.CallbackPath = &quot;/signin-github&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.AuthorizationEndpoint = &quot;https://github.com/login/oauth/authorize&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.TokenEndpoint = &quot;https://github.com/login/oauth/access_token&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.UserInformationEndpoint = &quot;https://api.github.com/user&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ClaimActions.MapJsonKey(ClaimTypes.NameIdentifier, &quot;id&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ClaimActions.MapJsonKey(ClaimTypes.Name, &quot;name&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ClaimActions.MapJsonKey(ClaimTypes.Email, &quot;email&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.ClaimActions.MapJsonKey(&quot;urn:github:login&quot;, &quot;login&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.Events = new OAuthEvents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OnCreatingTicket = async context =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var request = new HttpRequestMessage(HttpMethod.Get, context.Options.UserInformationEndpoint);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            request.Headers.Accept.Add(new MediaTypeWithQualityHeaderValue(&quot;application/json&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            request.Headers.Authorization = new AuthenticationHeaderValue(&quot;Bearer&quot;, context.AccessToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var response = await context.Backchannel.SendAsync(request, HttpCompletionOption.ResponseHeadersRead, context.HttpContext.RequestAborted);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            response.EnsureSuccessStatusCode();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var json = JsonDocument.Parse(await response.Content.ReadAsStringAsync());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context.RunClaimActions(json.RootElement);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var app = builder.Build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.UseAuthentication();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.UseAuthorization();</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases" translate="no">​</a></h3>
<ul>
<li>Single Sign-On (SSO) implementations</li>
<li>Third-party application integrations</li>
<li>API access delegation</li>
<li>Social media login (Google, Facebook, GitHub)</li>
<li>Enterprise identity federation</li>
<li>Mobile application authentication</li>
<li>Microservices security</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-use-vs-when-not-to-use">When to Use vs When Not to Use<a href="#when-to-use-vs-when-not-to-use" class="hash-link" aria-label="Direct link to When to Use vs When Not to Use" title="Direct link to When to Use vs When Not to Use" translate="no">​</a></h2>
<p><strong>Use When:</strong></p>
<ul>
<li>Integrating with external identity providers</li>
<li>Building APIs that need secure access</li>
<li>Implementing SSO across applications</li>
<li>Need standard-compliant authentication</li>
<li>Delegating user permissions to third parties</li>
<li>Enterprise authentication requirements</li>
</ul>
<p><strong>Don&#x27;t Use When:</strong></p>
<ul>
<li>Simple internal applications</li>
<li>No external integrations needed</li>
<li>Basic username/password sufficient</li>
<li>Performance is absolutely critical</li>
<li>Compliance doesn&#x27;t require it</li>
<li>Team lacks OAuth expertise</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="market-alternatives--adoption">Market Alternatives &amp; Adoption<a href="#market-alternatives--adoption" class="hash-link" aria-label="Direct link to Market Alternatives &amp; Adoption" title="Direct link to Market Alternatives &amp; Adoption" translate="no">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alternatives">Alternatives:<a href="#alternatives" class="hash-link" aria-label="Direct link to Alternatives:" title="Direct link to Alternatives:" translate="no">​</a></h3>
<ul>
<li>SAML 2.0 (older enterprise standard)</li>
<li>Custom JWT implementation</li>
<li>Basic Authentication</li>
<li>API Keys</li>
<li>Session-based authentication</li>
</ul>
<p><strong>Market Position:</strong> Industry standard for modern web authentication, adopted by all major platforms (Google, Microsoft, Facebook, etc.).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pros-and-cons">Pros and Cons<a href="#pros-and-cons" class="hash-link" aria-label="Direct link to Pros and Cons" title="Direct link to Pros and Cons" translate="no">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pros">Pros:<a href="#pros" class="hash-link" aria-label="Direct link to Pros:" title="Direct link to Pros:" translate="no">​</a></h3>
<ul>
<li>Industry standard protocol</li>
<li>Secure token-based authentication</li>
<li>Separates authentication from authorization</li>
<li>Supports multiple grant types</li>
<li>Excellent third-party support</li>
<li>Scalable for distributed systems</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cons">Cons:<a href="#cons" class="hash-link" aria-label="Direct link to Cons:" title="Direct link to Cons:" translate="no">​</a></h3>
<ul>
<li>Complex implementation</li>
<li>Multiple flow types can be confusing</li>
<li>Security misconfiguration risks</li>
<li>Token management overhead</li>
<li>Requires HTTPS</li>
<li>Learning curve for developers</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sample-implementation">Sample Implementation<a href="#sample-implementation" class="hash-link" aria-label="Direct link to Sample Implementation" title="Direct link to Sample Implementation" translate="no">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Models/TokenResponse.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class TokenResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [JsonPropertyName(&quot;access_token&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string AccessToken { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [JsonPropertyName(&quot;token_type&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string TokenType { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [JsonPropertyName(&quot;expires_in&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int ExpiresIn { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [JsonPropertyName(&quot;refresh_token&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string RefreshToken { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [JsonPropertyName(&quot;scope&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Scope { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Services/IOAuthService.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface IOAuthService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Task&lt;TokenResponse&gt; GetAccessTokenAsync(string authorizationCode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Task&lt;TokenResponse&gt; RefreshTokenAsync(string refreshToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Task&lt;ClaimsPrincipal&gt; GetUserInfoAsync(string accessToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string GenerateAuthorizationUrl(string state);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Services/OAuthService.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class OAuthService : IOAuthService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly HttpClient _httpClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IConfiguration _configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger&lt;OAuthService&gt; _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public OAuthService(HttpClient httpClient, IConfiguration configuration, ILogger&lt;OAuthService&gt; logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _httpClient = httpClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _configuration = configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string GenerateAuthorizationUrl(string state)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var authUrl = _configuration[&quot;OAuth:AuthorizationEndpoint&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var clientId = _configuration[&quot;OAuth:ClientId&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var redirectUri = _configuration[&quot;OAuth:RedirectUri&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var scope = _configuration[&quot;OAuth:Scope&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var queryParams = new Dictionary&lt;string, string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&quot;response_type&quot;] = &quot;code&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&quot;client_id&quot;] = clientId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&quot;redirect_uri&quot;] = redirectUri,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&quot;scope&quot;] = scope,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&quot;state&quot;] = state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var query = string.Join(&quot;&amp;&quot;, queryParams.Select(kv =&gt; $&quot;{kv.Key}={Uri.EscapeDataString(kv.Value)}&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return $&quot;{authUrl}?{query}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;TokenResponse&gt; GetAccessTokenAsync(string authorizationCode)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var tokenEndpoint = _configuration[&quot;OAuth:TokenEndpoint&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var clientId = _configuration[&quot;OAuth:ClientId&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var clientSecret = _configuration[&quot;OAuth:ClientSecret&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var redirectUri = _configuration[&quot;OAuth:RedirectUri&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var parameters = new List&lt;KeyValuePair&lt;string, string&gt;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;grant_type&quot;, &quot;authorization_code&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;code&quot;, authorizationCode),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;redirect_uri&quot;, redirectUri),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;client_id&quot;, clientId),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;client_secret&quot;, clientSecret)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var response = await _httpClient.PostAsync(tokenEndpoint, new FormUrlEncodedContent(parameters));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response.EnsureSuccessStatusCode();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var json = await response.Content.ReadAsStringAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return JsonSerializer.Deserialize&lt;TokenResponse&gt;(json);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;TokenResponse&gt; RefreshTokenAsync(string refreshToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var tokenEndpoint = _configuration[&quot;OAuth:TokenEndpoint&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var clientId = _configuration[&quot;OAuth:ClientId&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var clientSecret = _configuration[&quot;OAuth:ClientSecret&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var parameters = new List&lt;KeyValuePair&lt;string, string&gt;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;grant_type&quot;, &quot;refresh_token&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;refresh_token&quot;, refreshToken),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;client_id&quot;, clientId),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new(&quot;client_secret&quot;, clientSecret)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var response = await _httpClient.PostAsync(tokenEndpoint, new FormUrlEncodedContent(parameters));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response.EnsureSuccessStatusCode();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var json = await response.Content.ReadAsStringAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return JsonSerializer.Deserialize&lt;TokenResponse&gt;(json);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;ClaimsPrincipal&gt; GetUserInfoAsync(string accessToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var userInfoEndpoint = _configuration[&quot;OAuth:UserInfoEndpoint&quot;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _httpClient.DefaultRequestHeaders.Authorization =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new AuthenticationHeaderValue(&quot;Bearer&quot;, accessToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var response = await _httpClient.GetAsync(userInfoEndpoint);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response.EnsureSuccessStatusCode();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var json = await response.Content.ReadAsStringAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var userInfo = JsonDocument.Parse(json);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var claims = new List&lt;Claim&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        foreach (var property in userInfo.RootElement.EnumerateObject())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            claims.Add(new Claim(property.Name, property.Value.ToString()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var identity = new ClaimsIdentity(claims, &quot;OAuth&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new ClaimsPrincipal(identity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Controllers/AuthController.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ApiController]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Route(&quot;api/[controller]&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class AuthController : ControllerBase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IOAuthService _oauthService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger&lt;AuthController&gt; _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public AuthController(IOAuthService oauthService, ILogger&lt;AuthController&gt; logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _oauthService = oauthService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [HttpGet(&quot;login&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public IActionResult Login()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var state = Guid.NewGuid().ToString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HttpContext.Session.SetString(&quot;oauth_state&quot;, state);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var authUrl = _oauthService.GenerateAuthorizationUrl(state);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Redirect(authUrl);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [HttpGet(&quot;callback&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; Callback([FromQuery] string code, [FromQuery] string state)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var savedState = HttpContext.Session.GetString(&quot;oauth_state&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (state != savedState)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return BadRequest(&quot;Invalid state parameter&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var tokenResponse = await _oauthService.GetAccessTokenAsync(code);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var userInfo = await _oauthService.GetUserInfoAsync(tokenResponse.AccessToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Store tokens securely (consider using secure cookies or session)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            HttpContext.Session.SetString(&quot;access_token&quot;, tokenResponse.AccessToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            HttpContext.Session.SetString(&quot;refresh_token&quot;, tokenResponse.RefreshToken ?? &quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Sign in the user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await HttpContext.SignInAsync(CookieAuthenticationDefaults.AuthenticationScheme, userInfo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return Redirect(&quot;/dashboard&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogError(ex, &quot;OAuth callback failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return Redirect(&quot;/login?error=oauth_failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [HttpPost(&quot;refresh&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Authorize]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;ActionResult&lt;TokenResponse&gt;&gt; RefreshToken()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var refreshToken = HttpContext.Session.GetString(&quot;refresh_token&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (string.IsNullOrEmpty(refreshToken))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return BadRequest(&quot;No refresh token available&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var tokenResponse = await _oauthService.RefreshTokenAsync(refreshToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Update stored tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            HttpContext.Session.SetString(&quot;access_token&quot;, tokenResponse.AccessToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (!string.IsNullOrEmpty(tokenResponse.RefreshToken))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                HttpContext.Session.SetString(&quot;refresh_token&quot;, tokenResponse.RefreshToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return Ok(tokenResponse);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogError(ex, &quot;Token refresh failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return BadRequest(&quot;Token refresh failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [HttpPost(&quot;logout&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Authorize]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; Logout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HttpContext.Session.Clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await HttpContext.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Ok(&quot;Logged out successfully&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Middleware/TokenRefreshMiddleware.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class TokenRefreshMiddleware</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly RequestDelegate _next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IOAuthService _oauthService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public TokenRefreshMiddleware(RequestDelegate next, IOAuthService oauthService)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _next = next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _oauthService = oauthService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task InvokeAsync(HttpContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (context.User.Identity.IsAuthenticated)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var accessToken = context.Session.GetString(&quot;access_token&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (!string.IsNullOrEmpty(accessToken))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // Check if token is about to expire (implement token validation logic)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                var refreshToken = context.Session.GetString(&quot;refresh_token&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (!string.IsNullOrEmpty(refreshToken))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        var newTokens = await _oauthService.RefreshTokenAsync(refreshToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        context.Session.SetString(&quot;access_token&quot;, newTokens.AccessToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (!string.IsNullOrEmpty(newTokens.RefreshToken))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            context.Session.SetString(&quot;refresh_token&quot;, newTokens.RefreshToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    catch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // Token refresh failed, redirect to login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        context.Response.Redirect(&quot;/login&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await _next(context);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// appsettings.json configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;OAuth&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ClientId&quot;: &quot;your-client-id&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ClientSecret&quot;: &quot;your-client-secret&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;AuthorizationEndpoint&quot;: &quot;https://provider.com/oauth/authorize&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;TokenEndpoint&quot;: &quot;https://provider.com/oauth/token&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;UserInfoEndpoint&quot;: &quot;https://provider.com/oauth/userinfo&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;RedirectUri&quot;: &quot;https://localhost:5001/api/auth/callback&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Scope&quot;: &quot;openid profile email&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docusaurus_dotnet_overview/docs/Topics/Security/IdentityServer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">IdentityServer</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docusaurus_dotnet_overview/docs/Topics/Security/JWTTokens"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">JWTTokens</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#49-oauth-20--openid-connect" class="table-of-contents__link toc-highlight">49. OAuth 2.0 &amp; OpenID Connect</a><ul><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li></ul></li><li><a href="#official-definition" class="table-of-contents__link toc-highlight">Official Definition</a><ul><li><a href="#usage--setup" class="table-of-contents__link toc-highlight">Usage &amp; Setup</a></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a></li></ul></li><li><a href="#when-to-use-vs-when-not-to-use" class="table-of-contents__link toc-highlight">When to Use vs When Not to Use</a><ul><li><a href="#market-alternatives--adoption" class="table-of-contents__link toc-highlight">Market Alternatives &amp; Adoption</a></li><li><a href="#alternatives" class="table-of-contents__link toc-highlight">Alternatives:</a></li><li><a href="#pros-and-cons" class="table-of-contents__link toc-highlight">Pros and Cons</a></li><li><a href="#pros" class="table-of-contents__link toc-highlight">Pros:</a></li><li><a href="#cons" class="table-of-contents__link toc-highlight">Cons:</a></li><li><a href="#sample-implementation" class="table-of-contents__link toc-highlight">Sample Implementation</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus_dotnet_overview/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus_dotnet_overview/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/sreee2001" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Srikanth Tangella. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>