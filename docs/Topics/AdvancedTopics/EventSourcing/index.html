<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Topics/AdvancedTopics/EventSourcing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">EventSourcing | .NET and Azure Overview</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://sreee2001.github.io/docusaurus_dotnet_overview/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://sreee2001.github.io/docusaurus_dotnet_overview/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/EventSourcing"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="EventSourcing | .NET and Azure Overview"><meta data-rh="true" name="description" content="54. Event Sourcing"><meta data-rh="true" property="og:description" content="54. Event Sourcing"><link data-rh="true" rel="icon" href="/docusaurus_dotnet_overview/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/EventSourcing"><link data-rh="true" rel="alternate" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/EventSourcing" hreflang="en"><link data-rh="true" rel="alternate" href="https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/EventSourcing" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"EventSourcing","item":"https://sreee2001.github.io/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/EventSourcing"}]}</script><link rel="alternate" type="application/rss+xml" href="/docusaurus_dotnet_overview/blog/rss.xml" title=".NET and Azure Overview RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docusaurus_dotnet_overview/blog/atom.xml" title=".NET and Azure Overview Atom Feed"><link rel="stylesheet" href="/docusaurus_dotnet_overview/assets/css/styles.bda66df9.css">
<script src="/docusaurus_dotnet_overview/assets/js/runtime~main.fd1adcca.js" defer="defer"></script>
<script src="/docusaurus_dotnet_overview/assets/js/main.1e828174.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docusaurus_dotnet_overview/"><b class="navbar__title text--truncate">Quick References</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurus_dotnet_overview/docs/intro">Overviews</a><a class="navbar__item navbar__link" href="/docusaurus_dotnet_overview/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/sreee2001" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus_dotnet_overview/docs/intro"><span title="Welcome to .NET &amp; Azure Overview" class="linkLabel_WmDU">Welcome to .NET &amp; Azure Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docusaurus_dotnet_overview/docs/Topics/Fundamentals/dotnet_versions"><span title="Topics" class="categoryLinkLabel_W154">Topics</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Fundamentals/dotnet_versions"><span title="Fundamentals" class="categoryLinkLabel_W154">Fundamentals</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/CoreDevelopment/asp_dotnet_core"><span title="CoreDevelopment" class="categoryLinkLabel_W154">CoreDevelopment</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/WebTechnologies/mvc"><span title="WebTechnologies" class="categoryLinkLabel_W154">WebTechnologies</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DataAccessAndPersistence/entity_framework_core_advanced"><span title="DataAccessAndPersistence" class="categoryLinkLabel_W154">DataAccessAndPersistence</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Testing/unit_testing"><span title="Testing" class="categoryLinkLabel_W154">Testing</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/PerformanceAndScalability/caching"><span title="PerformanceAndScalability" class="categoryLinkLabel_W154">PerformanceAndScalability</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/CloudTechnologies/azure_app_service"><span title="CloudTechnologies" class="categoryLinkLabel_W154">CloudTechnologies</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/ContainerizationAndOrchestration/docker"><span title="ContainerizationAndOrchestration" class="categoryLinkLabel_W154">ContainerizationAndOrchestration</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/DevOps_and_CI_CD/azure_devops"><span title="DevOps_and_CI_CD" class="categoryLinkLabel_W154">DevOps_and_CI_CD</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Microservices/MicroservicesArchitecture"><span title="Microservices" class="categoryLinkLabel_W154">Microservices</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/Security/IdentityServer"><span title="Security" class="categoryLinkLabel_W154">Security</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/gRPC"><span title="AdvancedTopics" class="categoryLinkLabel_W154">AdvancedTopics</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/gRPC"><span title="gRPC" class="linkLabel_WmDU">gRPC</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/GraphQL"><span title="GraphQL" class="linkLabel_WmDU">GraphQL</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/EventSourcing"><span title="EventSourcing" class="linkLabel_WmDU">EventSourcing</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/CommandQueryResponsibilitySegregation"><span title="CommandQueryResponsibilitySegregation" class="linkLabel_WmDU">CommandQueryResponsibilitySegregation</span></a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docusaurus_dotnet_overview/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Topics</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">AdvancedTopics</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">EventSourcing</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>EventSourcing</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="54-event-sourcing">54. Event Sourcing<a href="#54-event-sourcing" class="hash-link" aria-label="Direct link to 54. Event Sourcing" title="Direct link to 54. Event Sourcing" translate="no">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="short-introduction">Short Introduction<a href="#short-introduction" class="hash-link" aria-label="Direct link to Short Introduction" title="Direct link to Short Introduction" translate="no">​</a></h2>
<p>Event Sourcing is an architectural pattern where state changes are stored as a sequence of events rather than storing just the current state. Instead of updating records in place, every change is appended as an event to an immutable log, allowing the system to reconstruct any past state and providing a complete audit trail.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="official-definition">Official Definition<a href="#official-definition" class="hash-link" aria-label="Direct link to Official Definition" title="Direct link to Official Definition" translate="no">​</a></h2>
<p>Event Sourcing ensures that all changes to application state are stored as a sequence of events. Not just can we query these events, we can also use the event log to reconstruct past states, and as a foundation to automatically adjust the state to cope with retroactive changes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setupusage-with-net-8-code">Setup/Usage with .NET 8+ Code<a href="#setupusage-with-net-8-code" class="hash-link" aria-label="Direct link to Setup/Usage with .NET 8+ Code" title="Direct link to Setup/Usage with .NET 8+ Code" translate="no">​</a></h2>
<p><strong>Installation:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package EventStore.Client.Grpc.Streams</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package MediatR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package System.Text.Json</span><br></span></code></pre></div></div>
<p><strong>Event Base Classes:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Events/DomainEvent.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract record DomainEvent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Guid Id { get; init; } = Guid.NewGuid();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime Timestamp { get; init; } = DateTime.UtcNow;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string EventType =&gt; GetType().Name;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int Version { get; init; } = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Events/BookingEvents.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public record BookingCreatedEvent(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Guid BookingId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int RoomId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DateTime CheckIn,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DateTime CheckOut,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    decimal TotalAmount) : DomainEvent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public record BookingConfirmedEvent(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Guid BookingId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DateTime ConfirmedAt) : DomainEvent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public record BookingCancelledEvent(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Guid BookingId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string Reason,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DateTime CancelledAt) : DomainEvent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public record PaymentProcessedEvent(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Guid BookingId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    decimal Amount,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string PaymentMethod,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string TransactionId) : DomainEvent;</span><br></span></code></pre></div></div>
<p><strong>Event Store Implementation:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Infrastructure/EventStore.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using EventStore.Client;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Text.Json;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface IEventStore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Task SaveEventsAsync(string streamName, IEnumerable&lt;DomainEvent&gt; events, long expectedVersion);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Task&lt;IEnumerable&lt;DomainEvent&gt;&gt; GetEventsAsync(string streamName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Task&lt;IEnumerable&lt;DomainEvent&gt;&gt; GetEventsAsync(string streamName, long fromVersion);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class EventStoreRepository : IEventStore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly EventStoreClient _client;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly JsonSerializerOptions _jsonOptions;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public EventStoreRepository(EventStoreClient client)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _client = client;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _jsonOptions = new JsonSerializerOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PropertyNamingPolicy = JsonNamingPolicy.CamelCase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task SaveEventsAsync(string streamName, IEnumerable&lt;DomainEvent&gt; events, long expectedVersion)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var eventData = events.Select(evt =&gt; new EventData(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Uuid.NewUuid(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            evt.EventType,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            JsonSerializer.SerializeToUtf8Bytes(evt, evt.GetType(), _jsonOptions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var revision = expectedVersion == -1 ? StreamRevision.None : StreamRevision.FromInt64(expectedVersion);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await _client.AppendToStreamAsync(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            streamName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            revision,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            eventData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IEnumerable&lt;DomainEvent&gt;&gt; GetEventsAsync(string streamName)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return await GetEventsAsync(streamName, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IEnumerable&lt;DomainEvent&gt;&gt; GetEventsAsync(string streamName, long fromVersion)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var events = new List&lt;DomainEvent&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var result = _client.ReadStreamAsync(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Direction.Forwards,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                streamName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                StreamPosition.FromInt64(fromVersion));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await foreach (var evt in result)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                var eventType = Type.GetType($&quot;HotelManagement.Events.{evt.Event.EventType}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (eventType != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    var eventData = JsonSerializer.Deserialize(evt.Event.Data.Span, eventType, _jsonOptions);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (eventData is DomainEvent domainEvent)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        events.Add(domainEvent);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (StreamNotFoundException)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Stream doesn&#x27;t exist yet, return empty list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return events;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Aggregate Root with Event Sourcing:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Domain/BookingAggregate.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class BookingAggregate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly List&lt;DomainEvent&gt; _uncommittedEvents = new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Guid Id { get; private set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string CustomerId { get; private set; } = string.Empty;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int RoomId { get; private set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime CheckIn { get; private set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime CheckOut { get; private set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public decimal TotalAmount { get; private set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BookingStatus Status { get; private set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public long Version { get; private set; } = -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // For reconstruction from events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BookingAggregate() { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // For creating new booking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BookingAggregate(Guid id, string customerId, int roomId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DateTime checkIn, DateTime checkOut, decimal totalAmount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var @event = new BookingCreatedEvent(id, customerId, roomId, checkIn, checkOut, totalAmount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Apply(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _uncommittedEvents.Add(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void ConfirmBooking()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (Status != BookingStatus.Pending)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new InvalidOperationException(&quot;Booking can only be confirmed when pending&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var @event = new BookingConfirmedEvent(Id, DateTime.UtcNow);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Apply(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _uncommittedEvents.Add(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void CancelBooking(string reason)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (Status == BookingStatus.Cancelled)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new InvalidOperationException(&quot;Booking is already cancelled&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var @event = new BookingCancelledEvent(Id, reason, DateTime.UtcNow);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Apply(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _uncommittedEvents.Add(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void ProcessPayment(decimal amount, string paymentMethod, string transactionId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (Status != BookingStatus.Confirmed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new InvalidOperationException(&quot;Payment can only be processed for confirmed bookings&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var @event = new PaymentProcessedEvent(Id, amount, paymentMethod, transactionId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Apply(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _uncommittedEvents.Add(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Apply events to rebuild state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Apply(DomainEvent @event)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        switch (@event)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case BookingCreatedEvent created:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Id = created.BookingId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                CustomerId = created.CustomerId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                RoomId = created.RoomId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                CheckIn = created.CheckIn;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                CheckOut = created.CheckOut;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                TotalAmount = created.TotalAmount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Status = BookingStatus.Pending;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case BookingConfirmedEvent confirmed:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Status = BookingStatus.Confirmed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case BookingCancelledEvent cancelled:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Status = BookingStatus.Cancelled;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case PaymentProcessedEvent payment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Status = BookingStatus.Paid;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Version++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void LoadFromHistory(IEnumerable&lt;DomainEvent&gt; events)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        foreach (var @event in events)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Apply(@event);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public IEnumerable&lt;DomainEvent&gt; GetUncommittedEvents() =&gt; _uncommittedEvents.AsReadOnly();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void MarkEventsAsCommitted() =&gt; _uncommittedEvents.Clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public enum BookingStatus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Pending,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Confirmed,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Cancelled,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Paid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Repository Pattern with Event Sourcing:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Infrastructure/BookingRepository.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface IBookingRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Task&lt;BookingAggregate?&gt; GetByIdAsync(Guid id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Task SaveAsync(BookingAggregate aggregate);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class EventSourcedBookingRepository : IBookingRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IEventStore _eventStore;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public EventSourcedBookingRepository(IEventStore eventStore)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _eventStore = eventStore;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;BookingAggregate?&gt; GetByIdAsync(Guid id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var streamName = $&quot;booking-{id}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var events = await _eventStore.GetEventsAsync(streamName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!events.Any())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var aggregate = new BookingAggregate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        aggregate.LoadFromHistory(events);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return aggregate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task SaveAsync(BookingAggregate aggregate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var streamName = $&quot;booking-{aggregate.Id}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var uncommittedEvents = aggregate.GetUncommittedEvents();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (uncommittedEvents.Any())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await _eventStore.SaveEventsAsync(streamName, uncommittedEvents, aggregate.Version - uncommittedEvents.Count());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            aggregate.MarkEventsAsCommitted();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Projection for Read Models:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Projections/BookingProjection.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class BookingProjection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Guid Id { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string CustomerId { get; set; } = string.Empty;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int RoomId { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime CheckIn { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime CheckOut { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public decimal TotalAmount { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Status { get; set; } = string.Empty;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime CreatedAt { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime? ConfirmedAt { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime? CancelledAt { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string? CancellationReason { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Projections/BookingProjectionHandler.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class BookingProjectionHandler :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INotificationHandler&lt;BookingCreatedEvent&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INotificationHandler&lt;BookingConfirmedEvent&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INotificationHandler&lt;BookingCancelledEvent&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly HotelDbContext _context;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BookingProjectionHandler(HotelDbContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _context = context;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task Handle(BookingCreatedEvent notification, CancellationToken cancellationToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var projection = new BookingProjection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Id = notification.BookingId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CustomerId = notification.CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RoomId = notification.RoomId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CheckIn = notification.CheckIn,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CheckOut = notification.CheckOut,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            TotalAmount = notification.TotalAmount,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Status = &quot;Pending&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CreatedAt = notification.Timestamp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _context.BookingProjections.Add(projection);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await _context.SaveChangesAsync(cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task Handle(BookingConfirmedEvent notification, CancellationToken cancellationToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var projection = await _context.BookingProjections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .FindAsync(notification.BookingId, cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (projection != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            projection.Status = &quot;Confirmed&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            projection.ConfirmedAt = notification.ConfirmedAt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await _context.SaveChangesAsync(cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task Handle(BookingCancelledEvent notification, CancellationToken cancellationToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var projection = await _context.BookingProjections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .FindAsync(notification.BookingId, cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (projection != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            projection.Status = &quot;Cancelled&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            projection.CancelledAt = notification.CancelledAt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            projection.CancellationReason = notification.Reason;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await _context.SaveChangesAsync(cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases" translate="no">​</a></h3>
<ul>
<li><strong>Audit Requirements</strong>: Complete audit trail of all changes</li>
<li><strong>Financial Systems</strong>: Immutable transaction history</li>
<li><strong>Temporal Queries</strong>: &quot;What was the state at time X?&quot;</li>
<li><strong>Event-Driven Architectures</strong>: Natural fit for event-driven systems</li>
<li><strong>Debugging and Analytics</strong>: Rich historical data for analysis</li>
<li><strong>Regulatory Compliance</strong>: Immutable record of business events</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-use-vs-when-not-to-use">When to Use vs When Not to Use<a href="#when-to-use-vs-when-not-to-use" class="hash-link" aria-label="Direct link to When to Use vs When Not to Use" title="Direct link to When to Use vs When Not to Use" translate="no">​</a></h2>
<p><strong>Use Event Sourcing when:</strong></p>
<ul>
<li>Need complete audit trail</li>
<li>Temporal queries are important</li>
<li>Building event-driven systems</li>
<li>Regulatory compliance requirements</li>
<li>Complex business processes with state transitions</li>
<li>Need to rebuild state from history</li>
</ul>
<p><strong>Consider alternatives when:</strong></p>
<ul>
<li>Simple CRUD operations</li>
<li>Limited development team experience</li>
<li>Real-time read performance is critical</li>
<li>Storage costs are a major concern</li>
<li>Simple domain logic</li>
<li>Need for simplicity outweighs benefits</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="market-alternatives--proscons">Market Alternatives &amp; Pros/Cons<a href="#market-alternatives--proscons" class="hash-link" aria-label="Direct link to Market Alternatives &amp; Pros/Cons" title="Direct link to Market Alternatives &amp; Pros/Cons" translate="no">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alternatives">Alternatives:<a href="#alternatives" class="hash-link" aria-label="Direct link to Alternatives:" title="Direct link to Alternatives:" translate="no">​</a></h3>
<ul>
<li><strong>Change Data Capture (CDC)</strong>: Database-level change tracking</li>
<li><strong>Audit Tables</strong>: Traditional audit logging</li>
<li><strong>Event Streaming</strong>: Kafka, Azure Event Hubs</li>
<li><strong>CQRS without Event Sourcing</strong>: Separate read/write models</li>
<li><strong>Traditional State Storage</strong>: Standard CRUD operations</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pros">Pros:<a href="#pros" class="hash-link" aria-label="Direct link to Pros:" title="Direct link to Pros:" translate="no">​</a></h3>
<ul>
<li>Complete audit trail</li>
<li>Natural fit for event-driven architecture</li>
<li>Ability to reconstruct any past state</li>
<li>Excellent for debugging and analysis</li>
<li>Scalable event processing</li>
<li>Strong consistency guarantees</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cons">Cons:<a href="#cons" class="hash-link" aria-label="Direct link to Cons:" title="Direct link to Cons:" translate="no">​</a></h3>
<ul>
<li>Increased complexity</li>
<li>Event schema evolution challenges</li>
<li>Storage requirements grow over time</li>
<li>Query complexity for current state</li>
<li>Learning curve for development teams</li>
<li>Eventual consistency in projections</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-runnable-sample">Complete Runnable Sample<a href="#complete-runnable-sample" class="hash-link" aria-label="Direct link to Complete Runnable Sample" title="Direct link to Complete Runnable Sample" translate="no">​</a></h3>
<p><strong>Program.cs Integration:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Program.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using EventStore.Client;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var builder = WebApplication.CreateBuilder(args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add EventStore client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var eventStoreSettings = EventStoreClientSettings.Create(&quot;esdb://localhost:2113?tls=false&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddSingleton(new EventStoreClient(eventStoreSettings));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add Event Sourcing services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddScoped&lt;IEventStore, EventStoreRepository&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddScoped&lt;IBookingRepository, EventSourcedBookingRepository&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add MediatR for projections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddMediatR(cfg =&gt; cfg.RegisterServicesFromAssembly(typeof(Program).Assembly));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add Entity Framework for projections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddDbContext&lt;HotelDbContext&gt;(options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.UseSqlServer(builder.Configuration.GetConnectionString(&quot;DefaultConnection&quot;)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var app = builder.Build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Example usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapPost(&quot;/bookings&quot;, async (CreateBookingCommand command, IBookingRepository repository) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var booking = new BookingAggregate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Guid.NewGuid(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command.CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command.RoomId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command.CheckIn,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command.CheckOut,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command.TotalAmount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await repository.SaveAsync(booking);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Results.Ok(booking.Id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapPut(&quot;/bookings/{id}/confirm&quot;, async (Guid id, IBookingRepository repository) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var booking = await repository.GetByIdAsync(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (booking == null) return Results.NotFound();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    booking.ConfirmBooking();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await repository.SaveAsync(booking);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Results.Ok();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Docker Compose for EventStore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version: &#x27;3.8&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  eventstore:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: eventstore/eventstore:21.10.0-buster-slim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - EVENTSTORE_CLUSTER_SIZE=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - EVENTSTORE_RUN_PROJECTIONS=All</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - EVENTSTORE_START_STANDARD_PROJECTIONS=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - EVENTSTORE_EXT_TCP_PORT=1113</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - EVENTSTORE_HTTP_PORT=2113</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - EVENTSTORE_INSECURE=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - EVENTSTORE_ENABLE_EXTERNAL_TCP=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - EVENTSTORE_ENABLE_ATOM_PUB_OVER_HTTP=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - &quot;1113:1113&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - &quot;2113:2113&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - eventstore-volume-data:/var/lib/eventstore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - eventstore-volume-logs:/var/log/eventstore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  eventstore-volume-data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  eventstore-volume-logs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.Run();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public record CreateBookingCommand(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int RoomId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DateTime CheckIn,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DateTime CheckOut,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    decimal TotalAmount);</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/GraphQL"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">GraphQL</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docusaurus_dotnet_overview/docs/Topics/AdvancedTopics/CommandQueryResponsibilitySegregation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CommandQueryResponsibilitySegregation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#54-event-sourcing" class="table-of-contents__link toc-highlight">54. Event Sourcing</a></li><li><a href="#short-introduction" class="table-of-contents__link toc-highlight">Short Introduction</a></li><li><a href="#official-definition" class="table-of-contents__link toc-highlight">Official Definition</a></li><li><a href="#setupusage-with-net-8-code" class="table-of-contents__link toc-highlight">Setup/Usage with .NET 8+ Code</a><ul><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a></li></ul></li><li><a href="#when-to-use-vs-when-not-to-use" class="table-of-contents__link toc-highlight">When to Use vs When Not to Use</a><ul><li><a href="#market-alternatives--proscons" class="table-of-contents__link toc-highlight">Market Alternatives &amp; Pros/Cons</a></li><li><a href="#alternatives" class="table-of-contents__link toc-highlight">Alternatives:</a></li><li><a href="#pros" class="table-of-contents__link toc-highlight">Pros:</a></li><li><a href="#cons" class="table-of-contents__link toc-highlight">Cons:</a></li><li><a href="#complete-runnable-sample" class="table-of-contents__link toc-highlight">Complete Runnable Sample</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus_dotnet_overview/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus_dotnet_overview/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/sreee2001" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Srikanth Tangella. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>