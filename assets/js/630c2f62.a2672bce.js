"use strict";(self.webpackChunkdotnet_overview=self.webpackChunkdotnet_overview||[]).push([[8777],{3752:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Topics/CoreDevelopment/Middleware","title":"Middleware","description":"Short Introduction","source":"@site/docs/Topics/02_CoreDevelopment/11_Middleware.md","sourceDirName":"Topics/02_CoreDevelopment","slug":"/Topics/CoreDevelopment/middleware","permalink":"/docusaurus_dotnet_overview/docs/Topics/CoreDevelopment/middleware","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"dotnet","permalink":"/docusaurus_dotnet_overview/docs/tags/dotnet"},{"inline":true,"label":"core","permalink":"/docusaurus_dotnet_overview/docs/tags/core"},{"inline":true,"label":"middleware","permalink":"/docusaurus_dotnet_overview/docs/tags/middleware"}],"version":"current","sidebarPosition":11,"frontMatter":{"slug":"middleware","title":"Middleware","tags":["dotnet","core","middleware"]},"sidebar":"tutorialSidebar","previous":{"title":"Logging","permalink":"/docusaurus_dotnet_overview/docs/Topics/CoreDevelopment/logging"},"next":{"title":"Authentication & Authorization","permalink":"/docusaurus_dotnet_overview/docs/Topics/CoreDevelopment/authentication_authorization"}}');var o=t(4848),i=t(8453);const s={slug:"middleware",title:"Middleware",tags:["dotnet","core","middleware"]},a="Middleware",l={},d=[{value:"Short Introduction",id:"short-introduction",level:2},{value:"Official Definition",id:"official-definition",level:2},{value:"Usage",id:"usage",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Sample Usage",id:"sample-usage",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"middleware",children:"Middleware"})}),"\n",(0,o.jsx)(n.h2,{id:"short-introduction",children:"Short Introduction"}),"\n",(0,o.jsx)(n.p,{children:"Middleware in ASP.NET Core forms the request processing pipeline, where each component can process requests and responses or pass them to the next component."}),"\n",(0,o.jsx)(n.h2,{id:"official-definition",children:"Official Definition"}),"\n",(0,o.jsx)(n.p,{children:"Middleware is software that's assembled into an application pipeline to handle requests and responses. Each component chooses whether to pass the request to the next component in the pipeline and can perform work before and after the next component in the pipeline is invoked."}),"\n",(0,o.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'// Built-in middleware\r\napp.UseHttpsRedirection();\r\napp.UseStaticFiles();\r\napp.UseRouting();\r\napp.UseAuthentication();\r\napp.UseAuthorization();\r\napp.MapControllers();\r\n\r\n// Custom middleware\r\npublic class RequestLoggingMiddleware\r\n{\r\n    private readonly RequestDelegate _next;\r\n    private readonly ILogger<RequestLoggingMiddleware> _logger;\r\n\r\n    public RequestLoggingMiddleware(RequestDelegate next, ILogger<RequestLoggingMiddleware> logger)\r\n    {\r\n        _next = next;\r\n        _logger = logger;\r\n    }\r\n\r\n    public async Task InvokeAsync(HttpContext context)\r\n    {\r\n        var stopwatch = Stopwatch.StartNew();\r\n\r\n        _logger.LogInformation("Request {Method} {Path} started",\r\n            context.Request.Method, context.Request.Path);\r\n\r\n        try\r\n        {\r\n            await _next(context);\r\n        }\r\n        finally\r\n        {\r\n            stopwatch.Stop();\r\n            _logger.LogInformation("Request {Method} {Path} completed in {ElapsedMilliseconds}ms with status {StatusCode}",\r\n                context.Request.Method,\r\n                context.Request.Path,\r\n                stopwatch.ElapsedMilliseconds,\r\n                context.Response.StatusCode);\r\n        }\r\n    }\r\n}\r\n\r\n// Register middleware\r\napp.UseMiddleware<RequestLoggingMiddleware>();\n'})}),"\n",(0,o.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Request/response logging"}),"\n",(0,o.jsx)(n.li,{children:"Authentication and authorization"}),"\n",(0,o.jsx)(n.li,{children:"Error handling"}),"\n",(0,o.jsx)(n.li,{children:"Rate limiting"}),"\n",(0,o.jsx)(n.li,{children:"Request/response modification"}),"\n",(0,o.jsx)(n.li,{children:"Cross-cutting concerns"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"sample-usage",children:"Sample Usage"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'// Error handling middleware\r\npublic class GlobalExceptionMiddleware\r\n{\r\n    private readonly RequestDelegate _next;\r\n    private readonly ILogger<GlobalExceptionMiddleware> _logger;\r\n\r\n    public GlobalExceptionMiddleware(RequestDelegate next, ILogger<GlobalExceptionMiddleware> logger)\r\n    {\r\n        _next = next;\r\n        _logger = logger;\r\n    }\r\n\r\n    public async Task InvokeAsync(HttpContext context)\r\n    {\r\n        try\r\n        {\r\n            await _next(context);\r\n        }\r\n        catch (Exception ex)\r\n        {\r\n            _logger.LogError(ex, "An unhandled exception occurred");\r\n            await HandleExceptionAsync(context, ex);\r\n        }\r\n    }\r\n\r\n    private static async Task HandleExceptionAsync(HttpContext context, Exception exception)\r\n    {\r\n        context.Response.ContentType = "application/json";\r\n\r\n        var response = exception switch\r\n        {\r\n            NotFoundException => new { message = exception.Message, statusCode = 404 },\r\n            ValidationException => new { message = exception.Message, statusCode = 400 },\r\n            UnauthorizedException => new { message = "Unauthorized", statusCode = 401 },\r\n            _ => new { message = "An error occurred", statusCode = 500 }\r\n        };\r\n\r\n        context.Response.StatusCode = response.statusCode;\r\n        await context.Response.WriteAsync(JsonSerializer.Serialize(response));\r\n    }\r\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var r=t(6540);const o={},i=r.createContext(o);function s(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);